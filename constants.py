
from __future__ import annotations

from datetime import timedelta
from typing import Dict, List, Optional

# =========================
# 外部検索：スレ全文キャッシュ（DB）
# =========================
THREAD_CACHE_TTL = timedelta(hours=6)   # 例：30分〜24時間で好み調整
MAX_CACHED_THREADS = 300                # 例：100〜1000で好み調整

# =========================
# 外部スレッド検索用 定数
# =========================
AREA_OPTIONS = [
    {"code": "",   "label": "地域を選択"},
    {"code": "1",  "label": "北海道版"},
    {"code": "14", "label": "北東北版（青森・岩手・秋田）"},
    {"code": "2",  "label": "南東北版（宮城・山形・福島）"},
    {"code": "15", "label": "北関東版（茨城・栃木・群馬）"},
    {"code": "3",  "label": "南関東・東京周辺版"},
    {"code": "4",  "label": "甲信越版（新潟・長野・山梨）"},
    {"code": "6",  "label": "北陸版（富山・石川・福井）"},
    {"code": "5",  "label": "東海版（愛知・岐阜・静岡・三重）"},
    {"code": "18", "label": "関西版（滋賀・京都・兵庫・奈良・和歌山）"},
    {"code": "7",  "label": "大阪版（大阪単独）"},
    {"code": "8",  "label": "山陽版（岡山・広島・山口）"},
    {"code": "12", "label": "山陰版（鳥取・島根）"},
    {"code": "9",  "label": "四国版（徳島・香川・愛媛・高知）"},
    {"code": "10", "label": "北部九州版（福岡・佐賀・長崎・大分）"},
    {"code": "16", "label": "南部九州版（熊本・宮崎・鹿児島）"},
    {"code": "11", "label": "沖縄版"},
]

BOARD_CATEGORY_OPTIONS = [
    {"id": "",      "label": "（カテゴリ指定なし）"},
    {"id": "103",   "label": "風俗掲示板"},
    {"id": "136",   "label": "メンエス・リフレ・癒し掲示板"},
    {"id": "122",   "label": "R18掲示板"},
]

# 板マスタ（カテゴリ別）
BOARD_MASTER: Dict[str, List[Dict[str, str]]] = {
    "103": [
        {"id": "439",  "label": "北海道風俗・お店"},
        {"id": "2508", "label": "北海道風俗・個人"},
        {"id": "2626", "label": "北海道風俗・総合"},
        {"id": "442",  "label": "札幌風俗・お店"},
        {"id": "1650", "label": "札幌風俗・個人"},
        {"id": "2509", "label": "札幌風俗・総合"},
        {"id": "2012", "label": "函館風俗・お店"},
        {"id": "2013", "label": "函館風俗・個人"},
        {"id": "2677", "label": "函館風俗・総合"},

        {"id": "239",  "label": "滋賀風俗・お店"},
        {"id": "1018", "label": "滋賀風俗・個人"},
        {"id": "1570", "label": "滋賀風俗・総合"},
        {"id": "103",  "label": "京都風俗・お店"},
        {"id": "1228", "label": "京都風俗・個人"},
        {"id": "1614", "label": "京都風俗・総合"},
        {"id": "436",  "label": "兵庫風俗・お店"},
        {"id": "975",  "label": "兵庫風俗・個人"},
        {"id": "1141", "label": "兵庫風俗・総合"},

        {"id": "410",  "label": "大阪風俗・お店"},
        {"id": "1227", "label": "大阪風俗・個人"},
        {"id": "332",  "label": "大阪風俗・総合"},
        {"id": "5922", "label": "大阪デリヘル・お店"},
        {"id": "5923", "label": "大阪デリヘル・個人"},
        {"id": "5924", "label": "大阪デリヘル・総合"},
        {"id": "3913", "label": "大阪遊郭・新地お店"},
        {"id": "5384", "label": "大阪遊郭・新地個人"},
        {"id": "3392", "label": "大阪遊郭・新地総合"},

        {"id": "472",  "label": "愛知風俗・お店"},
        {"id": "1229", "label": "愛知風俗・個人"},
        {"id": "1302", "label": "愛知風俗・総合"},

        {"id": "412",  "label": "東京風俗・お店"},
        {"id": "2020", "label": "東京風俗・個人"},
        {"id": "2026", "label": "東京風俗・総合"},
        {"id": "5919", "label": "東京デリヘル・お店"},
        {"id": "5920", "label": "東京デリヘル・個人"},
        {"id": "5921", "label": "東京デリヘル・総合"},
        {"id": "5869", "label": "東京外国人風俗・お店"},
        {"id": "5870", "label": "東京外国人風俗・総合"},
        {"id": "5072", "label": "吉原ソープ・お店"},
        {"id": "5074", "label": "吉原ソープ・個人"},
        {"id": "5073", "label": "吉原ソープ・総合"},
        {"id": "2277", "label": "西東京風俗・お店"},
        {"id": "2278", "label": "西東京風俗・個人"},
        {"id": "2640", "label": "西東京風俗・総合"},

        {"id": "447",  "label": "福岡風俗・お店"},
        {"id": "984",  "label": "福岡風俗・個人"},
        {"id": "1118", "label": "福岡風俗・総合"},
    ],
    "136": [
        {"id": "2887", "label": "北海道メンエス・リフレ・癒し・お店"},
        {"id": "4924", "label": "北海道メンエス・リフレ・癒し・個人"},
        {"id": "3342", "label": "北海道メンエス・リフレ・癒し・総合"},

        {"id": "2452", "label": "滋賀メンエス・リフレ・癒し・お店"},
        {"id": "4884", "label": "滋賀メンエス・リフレ・癒し・個人"},
        {"id": "3344", "label": "滋賀メンエス・リフレ・癒し・総合"},

        {"id": "2168", "label": "京都メンエス・リフレ・癒し・お店"},
        {"id": "4886", "label": "京都メンエス・リフレ・癒し・個人"},
        {"id": "2517", "label": "京都メンエス・リフレ・癒し・総合"},

        {"id": "1298", "label": "兵庫メンエス・リフレ・癒し・お店"},
        {"id": "4888", "label": "兵庫メンエス・リフレ・癒し・個人"},
        {"id": "2382", "label": "兵庫メンエス・リフレ・癒し・総合"},

        {"id": "1714", "label": "大阪メンエス・リフレ・癒し・お店"},
        {"id": "4887", "label": "大阪メンエス・リフレ・癒し・個人"},
        {"id": "2383", "label": "大阪メンエス・リフレ・癒し・総合"},
        {"id": "5878", "label": "大阪外国人メンエス・リフレ・癒し・お店"},
        {"id": "5882", "label": "大阪外国人メンエス・リフレ・癒し・総合"},

        {"id": "1326", "label": "愛知メンエス・リフレ・癒し・お店"},
        {"id": "4880", "label": "愛知メンエス・リフレ・癒し・個人"},
        {"id": "2375", "label": "愛知メンエス・リフレ・癒し・総合"},
        {"id": "5874", "label": "愛知外国人メンエス・リフレ・癒し・お店"},
        {"id": "5875", "label": "愛知外国人メンエス・リフレ・癒し・総合"},

        {"id": "2027", "label": "東京メンエス・リラクゼーション・お店"},
        {"id": "4876", "label": "東京メンエス・リラクゼーション・個人"},
        {"id": "2389", "label": "東京メンエス・リラクゼーション・総合"},
        {"id": "5871", "label": "東京外国人メンエス・リフレ・癒し・お店"},
        {"id": "5872", "label": "東京外国人メンエス・リフレ・癒し・総合"},

        {"id": "5060", "label": "西東京メンエス・リフレ・癒し・お店"},
        {"id": "5061", "label": "西東京メンエス・リフレ・癒し・個人"},
        {"id": "5062", "label": "西東京メンエス・リフレ・癒し・総合"},
        {"id": "5888", "label": "東京リフレ・癒し・お店"},
        {"id": "5889", "label": "東京リフレ・癒し・総合"},

        {"id": "1331", "label": "福岡メンエス・リフレ・癒し・お店"},
        {"id": "4899", "label": "福岡メンエス・リフレ・癒し・個人"},
        {"id": "2367", "label": "福岡メンエス・リフレ・癒し・総合"},
    ],
    "122": [
        {"id": "61",   "label": "Hな悩み"},
        {"id": "508",  "label": "チョットHな雑談"},
        {"id": "1804", "label": "ライブチャット"},
    ],
}

PERIOD_OPTIONS = [
    {"id": "all", "label": "すべて", "days": None},
    {"id": "7d", "label": "7日以内", "days": 7},
    {"id": "1m", "label": "1ヶ月以内", "days": 31},
    {"id": "3m", "label": "3ヶ月以内", "days": 93},
    {"id": "6m", "label": "6ヶ月以内", "days": 186},
    {"id": "1y", "label": "1年以内", "days": 365},
    {"id": "2y", "label": "2年以内", "days": 730},
]

_PERIOD_ID_TO_DAYS: Dict[str, Optional[int]] = {p["id"]: p["days"] for p in PERIOD_OPTIONS}


def get_period_days(period_id: str) -> Optional[int]:
    return _PERIOD_ID_TO_DAYS.get(period_id)


def get_board_options_for_category(board_category_id: str) -> List[Dict[str, str]]:
    board_category_id = (board_category_id or "").strip()
    return BOARD_MASTER.get(board_category_id, [])
